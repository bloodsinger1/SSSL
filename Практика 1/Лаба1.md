# Отчет по практической работе №1
## Растегаев И.Г. ББМО-01-23

## Установка 2 виртуальных машин
- Настроены две виртуальные машины с именами `rastegaev1` и `rastegaev2`.
![](https://i.imgur.com/yk6wiYd.png)

---

## Настройка сети
1. **Изменение конфигурации сетевых адаптеров**:
   - Для связи между виртуальными машинами выбран **внутренний адаптер (Host-only)**.
   - Для подключения к интернету использовался **NAT-адаптер**.
2. **Проверка связи**:
   - Выполнен пинг между `rastegaev1` и `rastegaev2`. Связь установлена успешно.

![](https://i.imgur.com/SEUMNdU.png)
![](https://i.imgur.com/Loe5ezY.png)
![](https://i.imgur.com/H1y31Et.png)

---

## Настройка rsyslog

### Настройка rsyslog на `rastegaev2` (сервер):
- Добавлены строки в конфигурацию `/etc/rsyslog.conf` для прослушивания сообщений через TCP и UDP.
- Выполнен перезапуск службы `rsyslog`.
![](https://i.imgur.com/fNWiMMS.png)
![](https://i.imgur.com/9MkNDOp.png)

### Настройка rsyslog на `rastegaev1` (клиент):
- Добавлена строка `*.* @@192.168.1.2:514` в конфигурацию для отправки логов на сервер `rastegaev2`.
- Перезапущена служба `rsyslog`.

**Результат:** Логи успешно передаются с клиента на сервер.

![](https://i.imgur.com/dK103ZI.png)
![](https://i.imgur.com/o4CAbLi.png)

---

## Установка и настройка Loki на сервере (rastegaev2)
- Установлен Loki из официального репозитория GitHub.
- Настроена конфигурация для приёма логов через rsyslog.
- Проверена доступность службы с помощью команды `curl http://localhost:3100/ready`. Сервис работает корректно.

**Комментарий:** Были сложности с конфигурацией сети, которые устранялись по ходу выполнения.

![](https://i.imgur.com/Zszyadu.png)
![](https://i.imgur.com/6sLhrVi.png)
![](https://i.imgur.com/AUTjMx8.png)
![](https://i.imgur.com/o5xr7At.png)

---

## Установка и настройка Promtail на `rastegaev1`
- Установлен Promtail из официального репозитория.
- Настроен для отправки логов на Loki (`rastegaev2`).
- В конфигурацию добавлены пути для мониторинга системных логов.

**Результат:** Promtail успешно отправляет логи в Loki.

![](https://i.imgur.com/5D1FY7M.png)
![](https://i.imgur.com/XatVyz2.png)
![](https://i.imgur.com/pvUHflH.png)
![](https://i.imgur.com/J4gMmFr.png)
![](https://i.imgur.com/9c6qnfx.png)
![](https://i.imgur.com/li7tooZ.png)
![](https://i.imgur.com/8O7MjxC.png)
---

## Установка SigNoz на сервере (rastegaev2)
1. **Установка:**
   - Клонирован репозиторий SigNoz.
   - Установлены Docker и Docker Compose для развёртывания SigNoz.
2. **Запуск контейнеров:**
   - Контейнеры `clickhouse` и `query-service` запущены.
   - В процессе были ошибки, связанные с отсутствием базы данных в ClickHouse.
3. **Исправления:**
   - Создана база данных `signoz` вручную в контейнере ClickHouse.
   - Конфигурация SigNoz скорректирована для указания правильного пути к базе данных.

**Комментарий:** Проблемы с правами доступа к Docker сокету и настройкой ClickHouse устранены.

![](https://i.imgur.com/tqgJ3zd.png)

---

## Итоги
В ходе практической работы выполнено:
1. Установка и настройка двух виртуальных машин.
2. Настройка rsyslog для передачи логов между машинами.
3. Установка Loki и Promtail для управления логами.
4. Частичная настройка SigNoz с устранением большинства возникающих проблем.



